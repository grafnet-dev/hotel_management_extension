<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
  <t t-name="rooms_planning.template" owl="1">
    <div class="o_action o_view_controller o_room_planning">
      <div class="o_content">
        <div class="p-3">
          
          <!-- En-t√™te avec navigation -->
          <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
              <h2 class="mb-1">
                <i class="fa fa-calendar me-2"/>
                Planning H√¥tel - Pr√©cision Horaire
              </h2>
              <p class="text-muted mb-0 small">Vue d√©taill√©e minute par minute</p>
            </div>
            
            <div class="btn-group">
              <button class="btn btn-secondary" t-on-click="previousWeek">
                <i class="fa fa-chevron-left"/>
              </button>
              <button class="btn btn-primary" t-on-click="today">
                <i class="fa fa-calendar-check-o me-1"/>
                Aujourd'hui
              </button>
              <button class="btn btn-secondary" t-on-click="nextWeek">
                <i class="fa fa-chevron-right"/>
              </button>
            </div>
          </div>

          <!-- L√©gende -->
          <div class="d-flex gap-2 mb-3 flex-wrap align-items-center">
            <small class="text-muted me-2">L√©gende:</small>
            <span class="badge" style="background-color: #4caf50;">üõèÔ∏è R√©servation</span>
            <span class="badge" style="background-color: #2196F3;">‚è±Ô∏è Day-use</span>
            <span class="badge" style="background-color: #ff9800;">üßπ Nettoyage</span>
            <span class="badge" style="background-color: #f44336;">üîß Maintenance</span>
          </div>

          <!-- Planning Grid -->
          <div class="planning-grid-container shadow-sm rounded">
            <div class="table-responsive">
              <table class="planning-table">
                
                <!-- En-t√™tes colonnes -->
                <thead>
                  <tr>
                    <th class="room-header">Chambres</th>
                    <t t-foreach="dates" t-as="date" t-key="date.iso">
                      <th class="date-header">
                        <div class="fw-bold"><t t-esc="date.dayName"/></div>
                        <div class="small text-muted"><t t-esc="date.display"/></div>
                      </th>
                    </t>
                  </tr>
                </thead>

                <!-- Lignes chambres -->
                <tbody>
                  <t t-foreach="rooms" t-as="room" t-key="room.id">
                    <tr class="room-row">
                      <td class="room-cell">
                        <div class="fw-bold"><t t-esc="room.name"/></div>
                      </td>
                      
                      <t t-foreach="dates" t-as="date" t-key="date.iso">
                        <td class="day-cell">
                          <div class="day-cell-content">
                            
                            <!-- Grille horaire l√©g√®re -->
                            <div class="hour-grid">
                              <div class="hour-line" style="left: 0%"/>
                              <div class="hour-line" style="left: 25%"/>
                              <div class="hour-line" style="left: 50%"/>
                              <div class="hour-line" style="left: 75%"/>
                            </div>

                            <!-- Blocs d'activit√©s -->
                            <t t-set="blocks" t-value="getBlocksForRoomAndDate(room.id, date.iso)"/>
                            <t t-foreach="blocks" t-as="block" t-key="block_index">
                              <div 
                                class="activity-block"
                                t-att-style="`left: ${block.left}%; width: ${block.width}%; background-color: ${block.color};`"
                                t-att-title="`${block.label} - ${block.startTime} √† ${block.endTime}`"
                                t-on-click="() => this.onBlockClick(block)"
                              >
                                <div class="activity-content">
                                  <div class="activity-icon">
                                    <t t-esc="getTypeIcon(block.type)"/>
                                  </div>
                                  <div class="activity-label">
                                    <t t-esc="block.label"/>
                                  </div>
                                  <div class="activity-time">
                                    <i class="fa fa-clock-o me-1"/>
                                    <t t-esc="block.startTime"/> - <t t-esc="block.endTime"/>
                                  </div>
                                </div>
                              </div>
                            </t>

                          </div>
                        </td>
                      </t>
                    </tr>
                  </t>
                </tbody>
              </table>
            </div>
          </div>

          <!-- √âchelle horaire -->
          <div class="mt-3 text-center">
            <small class="text-muted">
              <span class="me-4">00h (0%)</span>
              <span class="me-4">06h (25%)</span>
              <span class="me-4">12h (50%)</span>
              <span class="me-4">18h (75%)</span>
              <span>24h (100%)</span>
            </small>
          </div>

          <!-- Statistiques -->
          <div class="row mt-4 g-3">
            <div class="col-md-3">
              <div class="card stat-card">
                <div class="card-body text-center">
                  <i class="fa fa-pie-chart fa-2x text-primary mb-2"/>
                  <h6 class="text-muted mb-1">Taux d'occupation</h6>
                  <h3 class="text-primary mb-0">72%</h3>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card stat-card">
                <div class="card-body text-center">
                  <i class="fa fa-check-circle fa-2x text-success mb-2"/>
                  <h6 class="text-muted mb-1">Chambres libres</h6>
                  <h3 class="text-success mb-0">3</h3>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card stat-card">
                <div class="card-body text-center">
                  <i class="fa fa-bed fa-2x text-danger mb-2"/>
                  <h6 class="text-muted mb-1">Chambres occup√©es</h6>
                  <h3 class="text-danger mb-0">6</h3>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card stat-card">
                <div class="card-body text-center">
                  <i class="fa fa-wrench fa-2x text-warning mb-2"/>
                  <h6 class="text-muted mb-1">Maintenance</h6>
                  <h3 class="text-warning mb-0">1</h3>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </t>
</templates>