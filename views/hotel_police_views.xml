<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_form_hotel_police_form" model="ir.ui.view">
        <field name="name">hotel.police.form.view.form</field>
        <field name="model">hotel.police.form</field>
        <field name="arch" type="xml">
            <form string="Fiche de Police - Enregistrement Client">
                
                <!-- Alertes en haut -->
                <div class="alert alert-danger" invisible="not document_expired">
                    ‚ö†Ô∏è <strong>ATTENTION:</strong> Le document d'identit√© de ce client a expir√© !
                </div>
                
                <div class="alert alert-warning" invisible="not is_minor">
                    ‚ö†Ô∏è <strong>ATTENTION:</strong> Client mineur (moins de 18 ans) !
                </div>

                <!-- Section Client -->
                <group string="üë§ S√©lection du Client">
                    <field name="use_existing_client" string="Client existant"/>
                    
                    <!-- Mode client existant -->
                    <field name="partner_id" 
                           string="S√©lectionner un client"
                           invisible="not use_existing_client"
                           options="{'no_create': True}"
                           placeholder="Tapez le nom du client..."/>
                    
                    <!-- Bouton cr√©ation rapide client dans menu -->
                    <button name="action_open_new_client_form" 
                            string="‚ûï Ouvrir formulaire nouveau client"
                            type="object"
                            class="btn-link"
                            invisible="not use_existing_client"/>
                </group>

                <!-- Informations Client (auto-remplies ou √©ditables) -->
                <group string="üìã Identit√© du Client" col="2">
                    <group>
                        <field name="guest_name" 
                               readonly="use_existing_client and partner_id"
                               placeholder="Nom complet du client"/>
                        <field name="gender" 
                               readonly="use_existing_client and partner_id"/>
                        <field name="date_of_birth" 
                               readonly="use_existing_client and partner_id"/>
                    </group>
                    <group>
                        <field name="place_of_birth" 
                               readonly="use_existing_client and partner_id"/>
                        <field name="nationality" 
                               readonly="use_existing_client and partner_id"/>
                    </group>
                </group>

                <!-- Pi√®ce d'identit√© -->
                <group string="üÜî Pi√®ce d'Identit√©" col="2">
                    <group>
                        <field name="id_type" 
                               readonly="use_existing_client and partner_id"/>
                        <field name="id_number" 
                               readonly="use_existing_client and partner_id"
                               placeholder="Num√©ro de la pi√®ce d'identit√©"/>
                        <field name="id_issue_date" 
                               readonly="use_existing_client and partner_id"/>
                    </group>
                    <group>
                        <field name="id_expiry_date" 
                               readonly="use_existing_client and partner_id"/>
                        <field name="id_issue_place" 
                               readonly="use_existing_client and partner_id"/>
                        <field name="id_document_file" 
                               filename="id_document_filename"/>
                    </group>
                </group>

                <!-- Contact d'urgence (affich√© depuis le client) -->
                <group string="üìû Contact d'Urgence" 
                       invisible="not emergency_contact_name and use_existing_client">
                    <field name="emergency_contact_name" 
                           readonly="use_existing_client and partner_id"/>
                    <field name="emergency_contact_phone" 
                           readonly="use_existing_client and partner_id"/>
                </group>

                <!-- Informations s√©jour -->
                <group string="üè® Informations sur le S√©jour" col="2">
                    <group>
                        <field name="arrival_date"/>
                        <field name="departure_date"/>
                    </group>
                    <group>
                        <field name="room_number"/>
                    </group>
                </group>

                <!-- Observations -->
                <group string="üìù Observations">
                    <field name="notes" nolabel="1" placeholder="Observations particuli√®res sur le s√©jour..."/>
                </group>

                <!-- Champs invisibles pour les calculs -->
                <field name="document_expired" invisible="1"/>
                <field name="is_minor" invisible="1"/>

                <footer>
                    <!-- Bouton pour cr√©er nouveau client si mode nouveau -->
                    <button name="action_create_new_client"
                            string="‚ûï Cr√©er ce Client"
                            type="object"
                            class="btn-secondary"
                            invisible="use_existing_client or partner_id"/>
                    
                    <button name="action_validate_police_form"
                            string="‚úÖ Valider et Check-In"
                            type="object"
                            class="btn-primary"/>
                    
                    <button string="‚ùå Annuler"
                            special="cancel"
                            class="btn-secondary"/>
                </footer>
            </form>
        </field>
    </record>
</odoo>